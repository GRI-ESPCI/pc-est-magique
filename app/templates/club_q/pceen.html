{% extends "base.html" %} {% block app_content %}
<div class="row mb-3">
  <div class="col">
    <h3>{{ title }}</h3>
  </div>
</div>

<h4>{{ _("Informations : ")}}</h4>

<ul>
  <li>{{ _("Promotion : ")}} {{ pceen.promo}}</li>
  <li>{{ _("Mail : ")}} {{ pceen.email}}</li>
  {% if has_permission(PermissionType.write, PermissionScope.club_q) %}
  <li>{{ _("Mécontentement : ")}} {{ pceen.discontent}}</li>
  {% endif %}
</ul>

<h4>{{ _("Voeux : ")}}</h4>

<div class="row">
  <div class="col table-responsive">
    <table class="table table-striped table-hover table-bordered">
      <thead>
        <tr>
          <th scope="col">{{ _("ID") }}</th>
          <th scope="col">{{ _("Spectacle") }}</th>
          <th scope="col">{{ _("Priorité") }}</th>
          <th scope="col">{{ _("Demandées") }}</th>
          <th scope="col">{{ _("Minimum") }}</th>
          <th scope="col">{{ _("Attribuées") }}</th>
          {% if has_permission(PermissionType.write, PermissionScope.club_q) %}
          <th scope="col">{{ _("Disponibles") }}</th>
          <th scope="col">{{ _("Restantes") }}</th>
          {% endif %}
          <th scope="col">{{ _("Prix total") }}</th>
        </tr>
      </thead>

      <tbody>
        {% for voeu in voeux %}
        <tr>
          <td>{{ voeu.id }}</td>
          <td>{{ voeu.spectacle.nom }}</td>
          <td>{{ voeu.priorite }}</td>
          <td>{{ voeu.places_demandees }}</td>
          <td>{{ voeu.places_minimum }}</td>
          <td>{{ voeu.places_attribuees }}</td>
          {% if has_permission(PermissionType.write, PermissionScope.club_q) %}
          <td>{{ voeu.spectacle.nb_tickets}}</td>
          <td>
            {{ voeu.spectacle.nb_tickets -
            voeu.spectacle.sum_places_attribuees}}
          </td>
          {% endif %}
          <td>
            {{ babel.format_currency(voeu.spectacle.unit_price *
            voeu.places_attribuees, "EUR") }}
          </td>
        </tr>
        {% endfor %}
        <tr>
          <td><b>{{ _("Total") }}</b></td>
          <td><b>{{ _("-") }}</b></td>
          <td><b>{{ _("-") }}</b></td>
          <td><b>{{ pceen.sum_places_demandees }}</b></td>
          <td><b>{{ _("-") }}</b></td>
          <td><b>{{ pceen.sum_places_attribuees }}</b></td>
          {% if has_permission(PermissionType.write, PermissionScope.club_q) %}
          <td><b>{{ _("-") }}</b></td>
          <td><b>{{ _("-") }}</b></td>
          {% endif %}
          <td><b>{{ babel.format_currency(pceen.total_price, "EUR") }}</b></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<br />
<br />
<a class="btn btn-primary" 
    href="{{ url_for("club_q.generate_pdf", username=pceen.username) }}">
      {{ _("Imprimer la facture") }}
      
</a>


{% endblock %}
