{% extends "base.html" %} {% block app_content %}
{% if has_permission(PermissionType.write, PermissionScope.club_q) %}
<a class="btn btn-primary admin-button"" 
    href="{{ url_for("club_q.pceens") }}">
      {{ _("Administration") }}
      
</a>
<br />
<br />
{% endif %}

<div class="row mb-3">
  <div class="col">
    <h3>{{ title }}</h3>
  </div>
</div>


<h4>{{ _("Informations : ")}}</h4>

{% if has_permission(PermissionType.write, PermissionScope.club_q) %}
<ul>
  <li>{{ _("Promotion : ")}} {{ pceen.promo}}</li>
  <li>{{ _("Mail : ")}} {{ pceen.email}}</li>
  <li>{{ _("Mécontentement : ")}} {{ pceen.discontent}}</li>
</ul>
{% endif %}

<h4>{{ _("Voeux : ")}}</h4>

<div class="row">
  <div class="col table-responsive">
    <table class="table table-striped table-hover table-bordered">
      <thead>
        <tr>
          <th scope="col">{{ _("ID") }}</th>
          <th scope="col">{{ _("Spectacle") }}</th>
          <th scope="col">{{ _("Priorité") }}</th>
          <th scope="col">{{ _("Demandées") }}</th>
          <th scope="col">{{ _("Minimum") }}</th>
          <th scope="col">{{ _("Attribuées") }}</th>
          {% if has_permission(PermissionType.write, PermissionScope.club_q) %}
          <th scope="col">{{ _("Disponibles") }}</th>
          <th scope="col">{{ _("Restantes") }}</th>
          {% endif %}
          <th scope="col">{{ _("Prix total") }}</th>
        </tr>
      </thead>

      <tbody>
        {% for voeu in voeux %}
        <tr
          onclick="window.location='{{ url_for('club_q.spectacle', id=voeu.spectacle.id) }}';"
        >
          <td>{{ voeu.id }}</td>
          <td>{{ voeu.spectacle.nom }}</td>
          <td>{{ voeu.priorite }}</td>
          <td>{{ voeu.places_demandees }}</td>
          <td>{{ voeu.places_minimum }}</td>
          <td>{{ voeu.places_attribuees }}</td>
          {% if has_permission(PermissionType.write, PermissionScope.club_q) %}
          <td>{{ voeu.spectacle.nb_tickets}}</td>
          <td>
            {{ voeu.spectacle.nb_tickets -
            voeu.spectacle.sum_places_attribuees}}
          </td>
          {% endif %}
          <td>
            {{ babel.format_currency(voeu.spectacle.unit_price *
            voeu.places_attribuees, "EUR") }}
          </td>
        </tr>
        {% endfor %}
        <tr>
          <td><b>{{ _("Total") }}</b></td>
          <td><b>{{ _("-") }}</b></td>
          <td><b>{{ _("-") }}</b></td>
          <td><b>{{ pceen.sum_places_demandees }}</b></td>
          <td><b>{{ _("-") }}</b></td>
          <td><b>{{ pceen.sum_places_attribuees }}</b></td>
          {% if has_permission(PermissionType.write, PermissionScope.club_q) %}
          <td><b>{{ _("-") }}</b></td>
          <td><b>{{ _("-") }}</b></td>
          {% endif %}
          <td><b>{{ babel.format_currency(pceen.total_price, "EUR") }}</b></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<br />
<br />
<a class="btn btn-primary" 
    href="{{ url_for("club_q.user_generate_pdf", username=pceen.username) }}">
      {{ _("Imprimer la facture") }}
      
</a>

<style>
    /* Putting a red button for administration */
    .admin-button {
      background-color: rgb(195, 0, 0);
      border: 2px solid rgb(99, 0, 0);
    }
    .admin-button:hover {
      background-color: rgb(99, 0, 0);
      border: 2px solid rgb(99, 0, 0);
    }
  </style>
{% endblock %}
